<div class="expense-dialog">
  <button mat-icon-button class="close-btn" (click)="close()" aria-label="Cerrar">
    <mat-icon>close</mat-icon>
  </button>
  <div *ngIf="step === 1">
    <h2>Sube o arrastra tu recibo</h2>
    <input type="file" accept="image/*" (change)="onFileSelected($event)" />
    <button (click)="processReceipt()" [disabled]="!selectedFile">Procesar</button>
    <button (click)="close()">Cerrar</button>
  </div>

  <div *ngIf="step === 2">
    <h2>{{ mode === 'manual' ? 'Agrega tu gasto' : 'Revisa y edita tu gasto' }}</h2>
    <app-expense-form
      [initialData]="parsedExpense ?? undefined"
      (save)="onSave($event)"
      (cancel)="onCancel()"
    ></app-expense-form>
  </div>

  <div *ngIf="loading">Procesando con Gemini...</div>
</div>
