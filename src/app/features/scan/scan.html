<div class="scan-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="total-amount-card">
      <div class="amount-label">Monto total</div>
      <div class="total-amount">S/ {{ totalAmount | number:'1.2-2' }}</div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <div class="action-section">
        <h4>GASTOS</h4>
        <div class="buttons-row">
          <button class="action-btn scan-btn" (click)="openExpenseDialog('camera')">
            <div class="btn-icon">
              <i class="material-icons">camera_alt</i>
            </div>
            <div class="btn-icon-text-container" >
              Escanear
            </div>
          </button>
          <button class="action-btn upload-btn" (click)="openExpenseDialog('upload')">
            <div class="btn-icon">
              <i class="material-icons">cloud_upload</i>
            </div>
            <div class="btn-icon-text-container">
              Subir foto
            </div>
          </button>
          <button class="action-btn manual-btn" (click)="openExpenseDialog('manual')">
            <div class="btn-icon">
              <i class="material-icons">add</i>
            </div>
            <div class="btn-icon-text-container" >
              Agregar manualmente
            </div>
          </button>
        </div>
      </div>

      <div class="action-section">
        <h4>INGRESOS</h4>
        <div class="buttons-row">
          <button class="action-btn income-upload-btn" (click)="openIncomeDialog('upload')">
            <div class="btn-icon">
              <i class="material-icons">cloud_upload</i>
            </div>
            <div class="btn-icon-text-container" >
              Subir foto
            </div>
          </button>
          <button class="action-btn income-manual-btn" (click)="openIncomeDialog('manual')">
            <div class="btn-icon">
              <i class="material-icons">add</i>
            </div>
            <div class="btn-icon-text-container" >
              Agregar manualmente
            </div>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Movements Section -->
  <div class="movements-section">
    <div class="movements-header">
      <h3>Últimos Movimientos ({{ movements.length }})</h3>
      <a class="view-all-link" routerLink="all-movements">ver todos ></a>
    </div>

    <!-- Search Bar -->
    <div class="search-container">
      <div class="search-box">
        <i class="material-icons search-icon">search</i>
        <input type="text" placeholder="Buscar movimiento" class="search-input">
      </div>
    </div>

    <!-- Movements List -->
    <div class="movements-list">
      <ng-container *ngFor="let group of groupedMovements">
        <div class="date-group">
          <!-- Encabezado de fecha -->
          <div class="date-header">{{ formatDate(group.date) }}</div>

          <!-- Tarjeta de movimiento (usa las clases antiguas) -->
          <div class="expense-card" *ngFor="let movement of group.movements">
            <div class="expense-icon">
              <div
                class="icon-circle"
                [style.background-color]="getCategoryColor(movement.category)">
                <i class="material-icons">
                  {{ movement.type === 'expense'
                  ? getCategoryIcon(movement.category)
                  : 'attach_money' }}
                </i>
              </div>
            </div>

            <div class="expense-details">
              <div class="expense-place">
                <!-- Mostrar `place` si es gasto, `title` si es ingreso -->
                {{ movement.type === 'expense' ? movement.place : movement.title }}
              </div>
              <div class="expense-date">
                {{ formatDate(movement.date) }} • {{ movement.time }}
              </div>
            </div>

            <div class="expense-amount">
              <span [class]="getAmountClass(movement.type)">
                {{ formatAmount(movement.total, movement.type) }}
              </span>
              <i class="material-icons visibility-icon" (click)="openDetails(movement)">visibility</i>
            </div>
          </div>
        </div>
      </ng-container>
    </div>

  </div>
</div>
