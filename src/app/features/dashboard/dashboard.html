<!-- dashboard.html -->
<div class="dashboard-container">

  <!-- Header Section -->
  <div class="header-section">
    <div class="welcome-message">
      <h1>Hola {{ userName }}</h1>
      <p class="subtitle">Aqui puedes ver tus estadisticas</p>
    </div>

    <div class="notifications-section">
      <button mat-stroked-button class="notifications-btn" (click)="viewNotifications()">
        <mat-icon [matBadge]="unreadNotifications" matBadgeColor="accent" [matBadgeHidden]="unreadNotifications === 0">
          inbox
        </mat-icon>
        <span class="notifications-text">{{ unreadNotifications }} unread</span>
      </button>
      <button mat-icon-button [matMenuTriggerFor]="menu">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item>Ver todas</button>
        <button mat-menu-item>Marcar como leídas</button>
        <button mat-menu-item>Configuración</button>
      </mat-menu>
    </div>
  </div>

  <!-- KPIs Grid -->
  <div class="kpis-grid">
    <mat-card class="kpi-card">
      <mat-card-content>
        <div class="kpi-label">Total gastado este mes</div>
        <div class="kpi-value">S/ {{ totalGastadoMes }}</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="kpi-card">
      <mat-card-content>
        <div class="kpi-label">Categoría más alta</div>
        <div class="kpi-value category">{{ categoriaMasAlta }}</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="kpi-card">
      <mat-card-content>
        <div class="kpi-label">Presupuesto restante</div>
        <div class="kpi-value" [ngClass]="{ 'critico': isPresupuestoCritico }">
          S/ {{ presupuestoRestante }}
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="kpi-card">
      <mat-card-content>
        <div class="kpi-label">Proyección del próximo mes</div>
        <div class="kpi-value">
          S/ {{ proyeccionProximoMes }}
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Charts Grid -->
  <mat-grid-list [cols]="gridCols" rowHeight="400px" [gutterSize]="'20px'">

    <!-- Distribución de gastos por minicategorías -->
    <mat-grid-tile [colspan]="mainChartCols" [rowspan]="1">
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Distribución de gastos por minicategorías</mat-card-title>
          <button mat-button class="filter-btn">Past 30 Days ▼</button>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <!-- Aquí irá el chart de barras -->
            <canvas id="categoriasChart"></canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="sideChartCols" [rowspan]="1">
      <mat-card class="chart-card" id="ahorroChart">
        <mat-card-header>
          <mat-card-title>Evolución de ahorro</mat-card-title>
          <button mat-button class="filter-btn">Año actual</button>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas id="ahorroCanvas"></canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="1" [rowspan]="1">
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Proporción de categorías padres</mat-card-title>
          <button mat-button class="filter-btn">Past 24h ▼</button>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas id="proporcionChart"></canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="1" [rowspan]="1">
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Predicción de gastos por mes</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas id="prediccionChart"></canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

    <mat-grid-tile [colspan]="lastChartCols" [rowspan]="1">
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Gastos esenciales vs no esenciales</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas id="esencialesChart"></canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>

  </mat-grid-list>

</div>
